<!DOCTYPE html>
<html lang="en-us">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.4.0">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Kapil `%&gt;%` Khanal()">

  
  
  
    
  
  <meta name="description" content="Visually Classifying Bacteria and Antibiotics After World War II, antibiotics earned the moniker “wonder drugs” for quickly treating previously-incurable diseases. Data was gathered to determine which drug worked best for each bacterial infection. Comparing drug performance was an enormous aid for practitioners and scientists alike. In the fall of 1951, Will Burtin published a graph  showing the effectiveness of three popular antibiotics on 16 different bacteria, measured in terms of minimum inhibitory concentration.">

  
  <link rel="alternate" hreflang="en-us" href="/post/sankey/">

  


  

  
  
  
  <meta name="theme-color" content="#4caf50">
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.0/css/all.css" integrity="sha384-aOkxzJ5uQz7WBObEZcHvV5JvRW3TUc2rNPA7pe3AwnsUohiw1Vj2Rgx2KSOkF5+h" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" integrity="sha256-ygkqlh3CYSUri3LhQxzdcm0n1EQvH2Y+U5S2idbLtxs=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/github.min.css" crossorigin="anonymous" title="hl-light">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/github.min.css" crossorigin="anonymous" title="hl-dark" disabled>
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.2.0/leaflet.css" integrity="sha512-M2wvCLH6DSRazYeZRIm1JnYyh22purTM+FDB5CsyxtQJYeKq83arPe5wgbNmcFXGqiSH2XR8dT/fJISVA1r/zQ==" crossorigin="anonymous">
    

    

  

  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Cutive+Mono|Lora:400,700|Roboto:400,700&display=swap">
  

  
  
  
  <link rel="stylesheet" href="/css/academic.min.449e76f7356ceff2c572d1f113c1025b.css">

  

  
  
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-146497758-1', 'auto');
      
      ga('require', 'eventTracker');
      ga('require', 'outboundLinkTracker');
      ga('require', 'urlChangeTracker');
      ga('send', 'pageview');
    </script>
    <script async src="https://www.google-analytics.com/analytics.js"></script>
    
    <script async src="https://cdnjs.cloudflare.com/ajax/libs/autotrack/2.4.1/autotrack.js" integrity="sha512-HUmooslVKj4m6OBu0OgzjXXr+QuFYy/k7eLI5jdeEy/F4RSgMn6XRWRGkFi5IFaFgy7uFTkegp3Z0XnJf3Jq+g==" crossorigin="anonymous"></script>
    
  
  

  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/img/icon-32.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="/post/sankey/">

  
  
  
  
    
    
  
  
  <meta property="twitter:card" content="summary">
  
  <meta property="twitter:site" content="@Almost-Kapil">
  <meta property="twitter:creator" content="@Almost-Kapil">
  
  <meta property="og:site_name" content="Transponster">
  <meta property="og:url" content="/post/sankey/">
  <meta property="og:title" content="Sankey diagrams for Bacteria and antibiotics | Transponster">
  <meta property="og:description" content="Visually Classifying Bacteria and Antibiotics After World War II, antibiotics earned the moniker “wonder drugs” for quickly treating previously-incurable diseases. Data was gathered to determine which drug worked best for each bacterial infection. Comparing drug performance was an enormous aid for practitioners and scientists alike. In the fall of 1951, Will Burtin published a graph  showing the effectiveness of three popular antibiotics on 16 different bacteria, measured in terms of minimum inhibitory concentration."><meta property="og:image" content="/img/aph-salt-spring-zoom.jpg">
  <meta property="twitter:image" content="/img/aph-salt-spring-zoom.jpg"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2019-08-29T21:13:14-05:00">
    
    <meta property="article:modified_time" content="2019-08-29T21:13:14-05:00">
  

  


  





  <title>Sankey diagrams for Bacteria and antibiotics | Transponster</title>

</head>

<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  
<nav class="navbar navbar-light fixed-top navbar-expand-lg py-0 compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
      <a class="navbar-brand" href="/">Transponster</a>
      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
        <span><i class="fas fa-bars"></i></span>
      </button>
      

    
    <div class="collapse navbar-collapse" id="navbar">

      
      
      <ul class="navbar-nav mr-auto">
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#posts"><span>Posts</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#projects"><span>Projects</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/files/cv.pdf"><span>CV</span></a>
        </li>

        
        

      
      </ul>
      <ul class="navbar-nav ml-auto">
      

        

        
        <li class="nav-item">
          <a class="nav-link js-search" href="#"><i class="fas fa-search" aria-hidden="true"></i></a>
        </li>
        

        

        
        <li class="nav-item">
          <a class="nav-link js-dark-toggle" href="#"><i class="fas fa-moon" aria-hidden="true"></i></a>
        </li>
        

      </ul>

    </div>
  </div>
</nav>


  <article class="article" itemscope itemtype="http://schema.org/Article">

  












  

  
  
  
<div class="article-container pt-3">
  <h1 itemprop="name">Sankey diagrams for Bacteria and antibiotics</h1>

  

  
    



<meta content="2019-08-29 21:13:14 -0500 CDT" itemprop="datePublished">
<meta content="2019-08-29 21:13:14 -0500 CDT" itemprop="dateModified">

<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
    
    <time>Aug 29, 2019</time>
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    5 min read
  </span>
  

  
  
  

  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fas fa-folder mr-1"></i><a href="/categories/r/">R</a>, <a href="/categories/ggplot2/">ggplot2</a></span>
  

  
    
<div class="share-box" aria-hidden="true">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=/post/sankey/&amp;text=Sankey%20diagrams%20for%20Bacteria%20and%20antibiotics" target="_blank" rel="noopener" class="share-btn-twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=/post/sankey/&amp;t=Sankey%20diagrams%20for%20Bacteria%20and%20antibiotics" target="_blank" rel="noopener" class="share-btn-facebook">
          <i class="fab fa-facebook-f"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=Sankey%20diagrams%20for%20Bacteria%20and%20antibiotics&amp;body=/post/sankey/" target="_blank" rel="noopener" class="share-btn-email">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=/post/sankey/&amp;title=Sankey%20diagrams%20for%20Bacteria%20and%20antibiotics" target="_blank" rel="noopener" class="share-btn-linkedin">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://web.whatsapp.com/send?text=Sankey%20diagrams%20for%20Bacteria%20and%20antibiotics%20/post/sankey/" target="_blank" rel="noopener" class="share-btn-whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=/post/sankey/&amp;title=Sankey%20diagrams%20for%20Bacteria%20and%20antibiotics" target="_blank" rel="noopener" class="share-btn-weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>


  

</div>

    














  
</div>



  <div class="article-container">

    <div class="article-style" itemprop="articleBody">
      


<div id="visually-classifying-bacteria-and-antibiotics" class="section level2">
<h2>Visually Classifying Bacteria and Antibiotics</h2>
<p>After World War II, antibiotics earned the moniker “wonder drugs” for quickly treating previously-incurable diseases. Data was gathered to determine which drug worked best for each bacterial infection. Comparing drug performance was an enormous aid for practitioners and scientists alike. In the fall of 1951, Will Burtin published a <a href = "https://mbostock.github.io/protovis/ex/antibiotics-burtin.html">graph </a> showing the effectiveness of three popular antibiotics on <B>16</B> different bacteria, measured in terms of minimum inhibitory concentration.
I am reproducing this <a href = "https://www.dropbox.com/s/68ahri9xnnabce4/Bacteria-sigmoid-howto.docx?dl=0">wonderful visualization</a> from my professor in ggplot2, who did this in Tableau<a href = "http://driftlessdata.space/"> Silas Bergen</a>.</p>
<p>Let’s bring the datasets,</p>
<pre class="r"><code>library(tidyverse)
library(knitr)
library(kableExtra)
df &lt;- read.csv(&quot;https://cdn.rawgit.com/plotly/datasets/5360f5cd/Antibiotics.csv&quot;, stringsAsFactors = F)
#String as Factors is a demon. Better not bring it here ! We rarely need that beast.
#There are 16 bacteria so giving them ID to reference later..
df&lt;-df %&gt;% mutate(ID =seq(1:16) )</code></pre>
<pre class="r"><code>kable(head(df,n = 16))</code></pre>
<table>
<thead>
<tr>
<th style="text-align:left;">
Bacteria
</th>
<th style="text-align:right;">
Penicillin
</th>
<th style="text-align:right;">
Streptomycin
</th>
<th style="text-align:right;">
Neomycin
</th>
<th style="text-align:left;">
Gram
</th>
<th style="text-align:right;">
ID
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Mycobacterium tuberculosis
</td>
<td style="text-align:right;">
800.000
</td>
<td style="text-align:right;">
5.00
</td>
<td style="text-align:right;">
2.000
</td>
<td style="text-align:left;">
negative
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Salmonella schottmuelleri
</td>
<td style="text-align:right;">
10.000
</td>
<td style="text-align:right;">
0.80
</td>
<td style="text-align:right;">
0.090
</td>
<td style="text-align:left;">
negative
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
Proteus vulgaris
</td>
<td style="text-align:right;">
3.000
</td>
<td style="text-align:right;">
0.10
</td>
<td style="text-align:right;">
0.100
</td>
<td style="text-align:left;">
negative
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
Klebsiella pneumoniae
</td>
<td style="text-align:right;">
850.000
</td>
<td style="text-align:right;">
1.20
</td>
<td style="text-align:right;">
1.000
</td>
<td style="text-align:left;">
negative
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
Brucella abortus
</td>
<td style="text-align:right;">
1.000
</td>
<td style="text-align:right;">
2.00
</td>
<td style="text-align:right;">
0.020
</td>
<td style="text-align:left;">
negative
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
Pseudomonas aeruginosa
</td>
<td style="text-align:right;">
850.000
</td>
<td style="text-align:right;">
2.00
</td>
<td style="text-align:right;">
0.400
</td>
<td style="text-align:left;">
negative
</td>
<td style="text-align:right;">
6
</td>
</tr>
<tr>
<td style="text-align:left;">
Escherichia coli
</td>
<td style="text-align:right;">
100.000
</td>
<td style="text-align:right;">
0.40
</td>
<td style="text-align:right;">
0.100
</td>
<td style="text-align:left;">
negative
</td>
<td style="text-align:right;">
7
</td>
</tr>
<tr>
<td style="text-align:left;">
Salmonella (Eberthella) typhosa
</td>
<td style="text-align:right;">
1.000
</td>
<td style="text-align:right;">
0.40
</td>
<td style="text-align:right;">
0.008
</td>
<td style="text-align:left;">
negative
</td>
<td style="text-align:right;">
8
</td>
</tr>
<tr>
<td style="text-align:left;">
Aerobacter aerogenes
</td>
<td style="text-align:right;">
870.000
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.600
</td>
<td style="text-align:left;">
negative
</td>
<td style="text-align:right;">
9
</td>
</tr>
<tr>
<td style="text-align:left;">
Brucella antracis
</td>
<td style="text-align:right;">
0.001
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.007
</td>
<td style="text-align:left;">
positive
</td>
<td style="text-align:right;">
10
</td>
</tr>
<tr>
<td style="text-align:left;">
Streptococcus fecalis
</td>
<td style="text-align:right;">
1.000
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0.100
</td>
<td style="text-align:left;">
positive
</td>
<td style="text-align:right;">
11
</td>
</tr>
<tr>
<td style="text-align:left;">
Staphylococcus aureus
</td>
<td style="text-align:right;">
0.030
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
0.001
</td>
<td style="text-align:left;">
positive
</td>
<td style="text-align:right;">
12
</td>
</tr>
<tr>
<td style="text-align:left;">
Staphylococcus albus
</td>
<td style="text-align:right;">
0.007
</td>
<td style="text-align:right;">
0.10
</td>
<td style="text-align:right;">
0.001
</td>
<td style="text-align:left;">
positive
</td>
<td style="text-align:right;">
13
</td>
</tr>
<tr>
<td style="text-align:left;">
Streptococcus hemolyticus
</td>
<td style="text-align:right;">
0.001
</td>
<td style="text-align:right;">
14.00
</td>
<td style="text-align:right;">
10.000
</td>
<td style="text-align:left;">
positive
</td>
<td style="text-align:right;">
14
</td>
</tr>
<tr>
<td style="text-align:left;">
Streptococcus viridans
</td>
<td style="text-align:right;">
0.005
</td>
<td style="text-align:right;">
10.00
</td>
<td style="text-align:right;">
40.000
</td>
<td style="text-align:left;">
positive
</td>
<td style="text-align:right;">
15
</td>
</tr>
<tr>
<td style="text-align:left;">
Diplococcus pneumoniae
</td>
<td style="text-align:right;">
0.005
</td>
<td style="text-align:right;">
11.00
</td>
<td style="text-align:right;">
10.000
</td>
<td style="text-align:left;">
positive
</td>
<td style="text-align:right;">
16
</td>
</tr>
</tbody>
</table>
<p>Before proceeding further with the data manipulation we need to think about the format of the visualization. Here we will be making our visualization on the bacteria level, that means we will have information for each bacteria, their gram stain , and the concentration of drug required .</p>
<p>If you look at the table above, we do have all the data we need but not on the format we are thinking. We want one information per row for each bacteria unlike above where each row has all the information of each bacteria on one single row.
Let’s change the format of the data,</p>
<pre class="r"><code>key_value = df %&gt;% gather(&quot;Drug&quot;,&quot;Concentration&quot;,Penicillin:Neomycin,-Bacteria)
kable(head(key_value))</code></pre>
<table>
<thead>
<tr>
<th style="text-align:left;">
Bacteria
</th>
<th style="text-align:left;">
Gram
</th>
<th style="text-align:right;">
ID
</th>
<th style="text-align:left;">
Drug
</th>
<th style="text-align:right;">
Concentration
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Mycobacterium tuberculosis
</td>
<td style="text-align:left;">
negative
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
Penicillin
</td>
<td style="text-align:right;">
800
</td>
</tr>
<tr>
<td style="text-align:left;">
Salmonella schottmuelleri
</td>
<td style="text-align:left;">
negative
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Penicillin
</td>
<td style="text-align:right;">
10
</td>
</tr>
<tr>
<td style="text-align:left;">
Proteus vulgaris
</td>
<td style="text-align:left;">
negative
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
Penicillin
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
Klebsiella pneumoniae
</td>
<td style="text-align:left;">
negative
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
Penicillin
</td>
<td style="text-align:right;">
850
</td>
</tr>
<tr>
<td style="text-align:left;">
Brucella abortus
</td>
<td style="text-align:left;">
negative
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
Penicillin
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Pseudomonas aeruginosa
</td>
<td style="text-align:left;">
negative
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:left;">
Penicillin
</td>
<td style="text-align:right;">
850
</td>
</tr>
</tbody>
</table>
<p>okay so, now what we need to do is add a minimum concentration information for each bacteria for each stain type. so basically a column on the gathered table above. The only thing to keep note of is that here we should group all these bacteria and select the minimum concentration. We could have done this first[basically for eacg ] and gather like above but this is my thought process.</p>
<pre class="r"><code>df_min&lt;- key_value  %&gt;% 
  group_by(Bacteria) %&gt;% summarise(Min = min(Concentration))
kable(head(df_min))</code></pre>
<table>
<thead>
<tr>
<th style="text-align:left;">
Bacteria
</th>
<th style="text-align:right;">
Min
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Aerobacter aerogenes
</td>
<td style="text-align:right;">
1.000
</td>
</tr>
<tr>
<td style="text-align:left;">
Brucella abortus
</td>
<td style="text-align:right;">
0.020
</td>
</tr>
<tr>
<td style="text-align:left;">
Brucella antracis
</td>
<td style="text-align:right;">
0.001
</td>
</tr>
<tr>
<td style="text-align:left;">
Diplococcus pneumoniae
</td>
<td style="text-align:right;">
0.005
</td>
</tr>
<tr>
<td style="text-align:left;">
Escherichia coli
</td>
<td style="text-align:right;">
0.100
</td>
</tr>
<tr>
<td style="text-align:left;">
Klebsiella pneumoniae
</td>
<td style="text-align:right;">
1.000
</td>
</tr>
</tbody>
</table>
<p>so now, let’s join this <code>df_min</code> dataframe from above with <code>df</code> to have that minimum information in the dataframe.</p>
<pre class="r"><code>df&lt;- inner_join(df,df_min,by = &quot;Bacteria&quot;)
df&lt;- df %&gt;% mutate(Best = case_when(
  Penicillin == Min~ &quot;Penicillin&quot;,
  Neomycin == Min~ &quot;Neomycin&quot;,
  Streptomycin == Min~ &quot;Streptomycin&quot;
))</code></pre>
<p>Now, since the data is ready and in the format we want,</p>
<pre class="r"><code>kable(head(df))</code></pre>
<table>
<thead>
<tr>
<th style="text-align:left;">
Bacteria
</th>
<th style="text-align:right;">
Penicillin
</th>
<th style="text-align:right;">
Streptomycin
</th>
<th style="text-align:right;">
Neomycin
</th>
<th style="text-align:left;">
Gram
</th>
<th style="text-align:right;">
ID
</th>
<th style="text-align:right;">
Min
</th>
<th style="text-align:left;">
Best
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Mycobacterium tuberculosis
</td>
<td style="text-align:right;">
800
</td>
<td style="text-align:right;">
5.0
</td>
<td style="text-align:right;">
2.00
</td>
<td style="text-align:left;">
negative
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2.00
</td>
<td style="text-align:left;">
Neomycin
</td>
</tr>
<tr>
<td style="text-align:left;">
Salmonella schottmuelleri
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
0.8
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:left;">
negative
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:left;">
Neomycin
</td>
</tr>
<tr>
<td style="text-align:left;">
Proteus vulgaris
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:right;">
0.10
</td>
<td style="text-align:left;">
negative
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0.10
</td>
<td style="text-align:left;">
Neomycin
</td>
</tr>
<tr>
<td style="text-align:left;">
Klebsiella pneumoniae
</td>
<td style="text-align:right;">
850
</td>
<td style="text-align:right;">
1.2
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:left;">
negative
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:left;">
Neomycin
</td>
</tr>
<tr>
<td style="text-align:left;">
Brucella abortus
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2.0
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:left;">
negative
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:left;">
Neomycin
</td>
</tr>
<tr>
<td style="text-align:left;">
Pseudomonas aeruginosa
</td>
<td style="text-align:right;">
850
</td>
<td style="text-align:right;">
2.0
</td>
<td style="text-align:right;">
0.40
</td>
<td style="text-align:left;">
negative
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
0.40
</td>
<td style="text-align:left;">
Neomycin
</td>
</tr>
</tbody>
</table>
<p>Okay, this step might be a little unintuitive but if we think with <code>grammer of graphics</code> philosophy this will make sense.</p>
<pre class="r"><code>seq1 &lt;- rep(1:16,each=100)
seq2 &lt;-rep(seq(-6,6,length=100),16)
newdat &lt;-data.frame(ID=seq1,T=seq2)
write.csv(newdat,&quot;new_data.csv&quot;,row.names=FALSE)</code></pre>
<p>We are making a new dataframe that has data point for the sigmoid curve(you can just draw sigmoid curve in R but this way it is linked with our data with ID)</p>
<pre class="r"><code>#Joining the data by ID
final_df&lt;-inner_join(df,newdat,by = &quot;ID&quot;)
kable(head(final_df))</code></pre>
<table>
<thead>
<tr>
<th style="text-align:left;">
Bacteria
</th>
<th style="text-align:right;">
Penicillin
</th>
<th style="text-align:right;">
Streptomycin
</th>
<th style="text-align:right;">
Neomycin
</th>
<th style="text-align:left;">
Gram
</th>
<th style="text-align:right;">
ID
</th>
<th style="text-align:right;">
Min
</th>
<th style="text-align:left;">
Best
</th>
<th style="text-align:right;">
T
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Mycobacterium tuberculosis
</td>
<td style="text-align:right;">
800
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
negative
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Neomycin
</td>
<td style="text-align:right;">
-6.000000
</td>
</tr>
<tr>
<td style="text-align:left;">
Mycobacterium tuberculosis
</td>
<td style="text-align:right;">
800
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
negative
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Neomycin
</td>
<td style="text-align:right;">
-5.878788
</td>
</tr>
<tr>
<td style="text-align:left;">
Mycobacterium tuberculosis
</td>
<td style="text-align:right;">
800
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
negative
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Neomycin
</td>
<td style="text-align:right;">
-5.757576
</td>
</tr>
<tr>
<td style="text-align:left;">
Mycobacterium tuberculosis
</td>
<td style="text-align:right;">
800
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
negative
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Neomycin
</td>
<td style="text-align:right;">
-5.636364
</td>
</tr>
<tr>
<td style="text-align:left;">
Mycobacterium tuberculosis
</td>
<td style="text-align:right;">
800
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
negative
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Neomycin
</td>
<td style="text-align:right;">
-5.515151
</td>
</tr>
<tr>
<td style="text-align:left;">
Mycobacterium tuberculosis
</td>
<td style="text-align:right;">
800
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
negative
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Neomycin
</td>
<td style="text-align:right;">
-5.393939
</td>
</tr>
</tbody>
</table>
<pre class="r"><code>#ggplot
final_df &lt;- final_df %&gt;% mutate(Sigmoid = 1/(1 + exp(-T)))</code></pre>
<p>okay so now we have the final dataset, we can get in the ggplot2 land.</p>
<pre class="r"><code>p &lt;- ggplot(data = final_df , aes(x = T , y = Sigmoid ))
p + geom_point() </code></pre>
<p><img src="/post/sankey_files/figure-html/unnamed-chunk-10-1.png" width="1344" /></p>
<pre class="r"><code>#Making best slope
#Different slop will separate our curves
final_df&lt;-final_df %&gt;% mutate(bestBacSlope = case_when(
  Best ==&quot;Streptomycin&quot; ~ 4 - ID,
  Best ==&quot;Neomycin&quot; ~ 9 - ID,
  Best ==&quot;Penicillin&quot; ~ 14 - ID
))</code></pre>
<pre class="r"><code>final_df&lt;-final_df %&gt;% mutate(curveBest = ID + bestBacSlope * Sigmoid)
#Figuring out ID and labels

label_df&lt;-final_df %&gt;% dplyr::select(c(ID, Bacteria))%&gt;% group_by(Bacteria,ID) %&gt;% summarise(count = n()) %&gt;% dplyr::select(Bacteria,ID) %&gt;% arrange(ID)</code></pre>
<p>Below are the label we will use in y-axis</p>
<pre class="r"><code>label_y= c(&quot;Mycobacterium tuberculosis&quot; ,  &quot;Salmonella schottmuelleri&quot;  ,    
           &quot;Proteus vulgaris&quot;        ,        &quot;Klebsiella pneumoniae&quot;  ,        
           &quot;Brucella abortus&quot;      ,          &quot;Pseudomonas aeruginosa&quot;    ,     
           &quot;Escherichia coli&quot;    ,            &quot;Salmonella (Eberthella) typhosa&quot;,
           &quot;Aerobacter aerogenes&quot;     ,       &quot;Brucella antracis&quot;    ,          
           &quot;Streptococcus fecalis&quot;    ,       &quot;Staphylococcus aureus&quot;      ,    
           &quot;Staphylococcus albus&quot;    ,        &quot;Streptococcus hemolyticus&quot;      ,
           &quot;Streptococcus viridans&quot;    ,      &quot;Diplococcus pneumoniae&quot;)</code></pre>
<p>Now it’s a <code>plotting time</code> !</p>
<pre class="r"><code>#Plotting the sigmoid plots
library(ggthemes)</code></pre>
<pre><code>## Warning: package &#39;ggthemes&#39; was built under R version 3.5.2</code></pre>
<pre class="r"><code>sankey &lt;- ggplot(data = final_df, aes(x = T , y = curveBest, color =Gram,size = Min,alpha = 0.9,group = Bacteria)) + geom_line() +scale_fill_manual(values=c(&quot;green&quot;,&quot;red&quot;)) + 
    scale_y_continuous(breaks = seq(1:16) , labels = label_y)   + theme(axis.title.y = element_blank() , axis.line.x  = element_blank() , axis.ticks.x = element_blank(), axis.title.x =element_blank() , axis.text.x.bottom = element_blank() ) + 
  annotate(&quot;text&quot;, x = 6, y = 14, label = &quot;Penicillin&quot;) +
  annotate(&quot;text&quot;, x = 6, y = 9, label = &quot;Neomycin&quot;) +
  annotate(&quot;text&quot;, x = 6, y = 4, label = &quot;Streptomycin&quot;) +
  annotate(&quot;text&quot;,x = 5.5,y = 15,label = &quot;Best Antibiotics&quot; ,size = 5, colour = &#39;blue&#39;)+
  theme_minimal()</code></pre>
<pre class="r"><code>sankey</code></pre>
<div class="figure"><span id="fig:sankey"></span>
<img src="/post/sankey_files/figure-html/sankey-1.png" alt="Classification of Bacteria" width="1344" />
<p class="caption">
Figure 1: Classification of Bacteria
</p>
</div>
</div>

    </div>

    


    

<div class="article-tags">
  
  <a class="badge badge-light" href="/tags/ggplot2/">ggplot2</a>
  
  <a class="badge badge-light" href="/tags/data-visualization/">Data Visualization</a>
  
  <a class="badge badge-light" href="/tags/data-communication/">Data Communication</a>
  
</div>



    
      








  





  
  
  
    
  
  
  <div class="media author-card" itemscope itemtype="http://schema.org/Person">
    
      
      <img class="portrait mr-3" src="/authors/admin/avatar_hu27f7dc34c9db8fd2b063f3fba6be9864_580990_250x250_fill_q75_box_center.jpg" itemprop="image" alt="Avatar">
    

    <div class="media-body">
      <h5 class="card-title" itemprop="name"><a href="/">Kapil `%&gt;%` Khanal()</a></h5>
      <h6 class="card-subtitle">Student and Peer Tutor</h6>
      <p class="card-text" itemprop="description">My research interests include Mathematical Systems , Machine learning , Data Systems and Functional Programming.</p>
      <ul class="network-icon" aria-hidden="true">
        
          
          
          
            
          
          
          
          
          
            
          
          <li>
            <a itemprop="sameAs" href="/#contact" >
              <i class="fas fa-envelope"></i>
            </a>
          </li>
        
          
          
          
            
          
          
          
          
          
            
          
          <li>
            <a itemprop="sameAs" href="https://twitter.com/almostKapil" target="_blank" rel="noopener">
              <i class="fab fa-twitter"></i>
            </a>
          </li>
        
          
          
          
            
          
          
          
          
          
            
          
          <li>
            <a itemprop="sameAs" href="https://github.com/KapilKhanal" target="_blank" rel="noopener">
              <i class="fab fa-github"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>



      
      
    

    

    


  </div>
</article>

      

    
    

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" integrity="sha256-X5PoE3KU5l+JcX+w09p/wHl9AzK333C4hJ2I9S5mD4M=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js" integrity="sha256-aYTdUrn6Ow1DDgh5JTc3aDGnnju48y/1c8s1dgkYPQ8=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/r.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/python.min.js"></script>
        
      

      
      
    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.2.0/leaflet.js" integrity="sha512-lInM/apFSqyy1o6s89K4iQUKg6ppXEgsVxT35HbzUupEVRh2Eu9Wdl4tHj7dZO0s1uvplcYGmt3498TtHq+log==" crossorigin="anonymous"></script>
    

    
    
    <script>hljs.initHighlightingOnLoad();</script>
    

    
    
    <script>
      const search_index_filename = "/index.json";
      const i18n = {
        'placeholder': "Search...",
        'results': "results found",
        'no_results': "No results found"
      };
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/academic.min.16bbb3750feb7244c9bc409a5a4fe678.js"></script>

    






  
  <div class="container">
    <footer class="site-footer">
  
  <p class="powered-by">
    
      <a href="/privacy/">Privacy Policy</a>
    
    
       &middot; 
      <a href="/terms/">Terms</a>
        
  </p>
  

  <p class="powered-by">
    &copy; 2018 Kapil Khanal &middot; 

    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
    <span class="float-right" aria-hidden="true">
      <a href="#" id="back_to_top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
